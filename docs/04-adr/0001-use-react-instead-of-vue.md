# 1. 选择Flask而非Django作为后端框架

*   日期: 2025-10-15
*   决策者: @林文进（后端工程师）, @林哲凯（项目经理）, @杨鹏祥（运维工程师）

## 上下文与问题陈述

在启动CTF平台项目时，我们需要选择一个适合的Python Web框架。项目需求如下：

1. 需要快速开发一个功能完整的CTF竞赛平台
2. 团队规模较小（6人），需要灵活的架构
3. 预计用户量中等（500-1000并发用户）
4. 需要良好的RESTful API支持
5. 团队成员对Python Web框架有不同经验

## 决策因素

*   **开发速度**：需要快速交付MVP版本
*   **灵活性**：需要根据CTF特殊需求进行定制
*   **学习曲线**：团队成员的学习成本
*   **社区支持**：遇到问题时能否快速找到解决方案
*   **性能要求**：能够处理中等规模的并发请求
*   **维护成本**：长期维护的难易程度
*   **可扩展性**：未来可能的功能扩展需求

## 考虑的方案

### 方案 A：使用Flask框架

- 轻量级、微框架设计
- 灵活的扩展机制
- 学习曲线平缓
- 丰富的插件生态系统
- 适合小型到中型项目

### 方案 B：使用Django框架

- 全功能、开箱即用
- 内置ORM、Admin、认证等系统
- 结构严谨，约定优于配置
- 适合大型企业级应用
- 内置的安全性功能

### 方案 C：使用FastAPI框架

- 现代异步框架
- 自动API文档生成
- 性能优秀
- 相对较新，生态系统在发展中

## 决策结果

选择**方案A（Flask框架）**，原因如下：

1. **灵活性需求**：CTF平台有许多特殊需求（如动态积分计算、Flag验证逻辑、排行榜算法），Flask的微框架设计允许我们灵活实现这些定制功能，而不会受到Django"约定优于配置"原则的约束。

2. **团队经验**：
   - 后端工程师林文进有丰富的Flask开发经验
   - 运维工程师杨鹏祥熟悉Flask的部署和监控
   - 测试工程师宋礼雄熟悉Flask应用的测试模式

3. **项目规模匹配**：Flask非常适合中小型Web应用，而CTF平台预估的规模和复杂度在Flask的最佳适用范围内。

4. **快速原型开发**：Flask的简单性使得我们可以快速构建MVP，让前端工程师卢圣轩能够尽早开始前端集成工作。

5. **逐步扩展**：Flask的蓝图（Blueprint）机制支持模块化开发，随着功能增加可以保持良好的代码组织。

6. **数据库选择自由**：虽然我们选择了MySQL，但Flask-SQLAlchemy支持多种数据库，未来如果需要切换或扩展，更加灵活。

## 后果

### 积极后果 ✅

1. **快速开发**：团队在2周内完成了MVP版本，验证了核心功能。
2. **灵活定制**：成功实现了动态积分系统、Flag验证逻辑等CTF特有功能。
3. **代码简洁**：项目代码结构清晰，新成员（渗透工程师刘城铭）能够快速理解代码。
4. **部署简单**：Windows环境下Flask应用的部署和调试相对简单。
5. **资源消耗低**：Flask的轻量级特性使得服务器资源消耗较低。

### 消极后果 ❌

1. **需要更多配置**：相比Django，我们需要自己选择和集成许多组件（如认证、ORM、表单验证等）。
2. **安全责任**：需要手动实现一些Django内置的安全功能，增加了开发工作量。
3. **初期架构设计**：团队需要花费时间设计合理的项目结构，而Django已经提供了成熟的项目结构。
4. **部分功能缺失**：如Django Admin这样的成熟后台管理系统需要我们自己实现。

### 缓解措施

1. **标准化配置**：创建了统一的项目模板和配置管理，减少重复工作。
2. **安全审计**：渗透工程师刘城铭定期进行代码安全审计，弥补框架安全功能的不足。
3. **文档完善**：详细记录了Flask项目的结构和开发规范。
4. **使用成熟扩展**：选择了经过验证的Flask扩展（Flask-SQLAlchemy、Flask-Login、Flask-JWT等）。

### 验证指标

| 指标             | 目标   | 实际结果 | 状态 |
| ---------------- | ------ | -------- | ---- |
| MVP交付时间      | 3周    | 2周      | ✅    |
| 核心API数量      | 15个   | 22个     | ✅    |
| 平均响应时间     | <200ms | 150ms    | ✅    |
| 代码可维护性评分 | 8/10   | 8.5/10   | ✅    |

## 补充说明

此决策适用于当前项目阶段（v1.0-v2.0）。如果项目发展到需要企业级功能（如多租户、复杂权限系统、大规模分布式部署），可能需要重新评估是否迁移到Django或采用其他架构。

---

**相关文档**：/docs/01-architecture/backend-architecture.md  
**代码位置**：app.py, config.py, models.py, routes/